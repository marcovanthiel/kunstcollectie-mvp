"use strict";(()=>{var e={};e.id=610,e.ids=[610],e.modules={3524:e=>{e.exports=require("@prisma/client")},7096:e=>{e.exports=require("bcrypt")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5959:(e,t,a)=>{a.r(t),a.d(t,{config:()=>u,default:()=>d,routeModule:()=>p});var r={};a.r(r),a.d(r,{default:()=>l});var n=a(1802),o=a(7153),s=a(6249),i=a(7864),c=a(9823);let handler=async(e,t)=>{switch(e.method){case"GET":return getLocations(e,t);case"POST":return createLocation(e,t);default:return t.setHeader("Allow",["GET","POST"]),t.status(405).json({error:`Methode ${e.method} niet toegestaan`})}},getLocations=async(e,t)=>{try{let{search:a,type:r,page:n=1,limit:o=10}=e.query,s={};a&&(s.OR=[{name:{contains:a,mode:"insensitive"}},{address:{contains:a,mode:"insensitive"}},{city:{contains:a,mode:"insensitive"}}]),r&&(s.typeId=parseInt(r));let c=(parseInt(n)-1)*parseInt(o),[l,d]=await Promise.all([i.Z.location.findMany({where:s,include:{locationType:!0,_count:{select:{artworks:!0}}},skip:c,take:parseInt(o),orderBy:{name:"asc"}}),i.Z.location.count({where:s})]),u=l.map(e=>({...e,artworkCount:e._count.artworks}));return t.status(200).json({locations:u,pagination:{total:d,page:parseInt(n),limit:parseInt(o),pages:Math.ceil(d/parseInt(o))}})}catch(e){return console.error("Error fetching locations:",e),t.status(500).json({error:"Er is een fout opgetreden bij het ophalen van locaties."})}},createLocation=async(e,t)=>{try{let{name:a,address:r,postalCode:n,city:o,country:s,typeId:c,notes:l}=e.body;if(!a||!r||!o||!c)return t.status(400).json({error:"Naam, adres, stad en type zijn verplicht."});let d=await i.Z.location.create({data:{name:a,address:r,postalCode:n,city:o,country:s,typeId:parseInt(c),notes:l},include:{locationType:!0}});return t.status(201).json(d)}catch(e){return console.error("Error creating location:",e),t.status(500).json({error:"Er is een fout opgetreden bij het aanmaken van de locatie."})}},l=(0,c.fS)(handler),d=(0,s.l)(r,"default"),u=(0,s.l)(r,"config"),p=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/locations",pathname:"/api/locations",bundlePath:"",filename:""},userland:r})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[222,896],()=>__webpack_exec__(5959));module.exports=a})();