"use strict";(()=>{var e={};e.id=577,e.ids=[577],e.modules={3524:e=>{e.exports=require("@prisma/client")},7096:e=>{e.exports=require("bcrypt")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},8001:(e,t,r)=>{r.r(t),r.d(t,{config:()=>d,default:()=>p,routeModule:()=>c});var a={};r.r(a),r.d(a,{default:()=>u});var n=r(1802),s=r(7153),o=r(6249),i=r(7864),l=r(9823);let handler=async(e,t)=>{switch(e.method){case"GET":return getArtworks(e,t);case"POST":return createArtwork(e,t);default:return t.setHeader("Allow",["GET","POST"]),t.status(405).json({error:`Methode ${e.method} niet toegestaan`})}},getArtworks=async(e,t)=>{try{let{artistId:r,locationId:a,typeId:n,search:s,minValue:o,maxValue:l,page:u=1,limit:p=10}=e.query,d={};r&&(d.artistId=parseInt(r)),a&&(d.locationId=parseInt(a)),n&&(d.typeId=parseInt(n)),s&&(d.OR=[{title:{contains:s,mode:"insensitive"}},{description:{contains:s,mode:"insensitive"}}]),o&&(d.marketValue={gte:parseFloat(o)}),l&&(d.marketValue={...d.marketValue,lte:parseFloat(l)});let c=(parseInt(u)-1)*parseInt(p),[k,w]=await Promise.all([i.Z.artwork.findMany({where:d,include:{artist:{select:{id:!0,name:!0}},artworkType:{select:{id:!0,name:!0}},location:{select:{id:!0,name:!0}},images:{where:{isPrimary:!0},take:1}},skip:c,take:parseInt(p),orderBy:{title:"asc"}}),i.Z.artwork.count({where:d})]);return t.status(200).json({artworks:k,pagination:{total:w,page:parseInt(u),limit:parseInt(p),pages:Math.ceil(w/parseInt(p))}})}catch(e){return console.error("Error fetching artworks:",e),t.status(500).json({error:"Er is een fout opgetreden bij het ophalen van kunstwerken."})}},createArtwork=async(e,t)=>{try{let{title:r,artistId:a,typeId:n,height:s,width:o,depth:l,weight:u,year:p,estimated:d,isEdition:c,editionDesc:k,isSigned:w,signatureDesc:h,description:m,locationId:I,purchaseDate:g,purchasePrice:y,supplier:f,marketValue:j,insuredValue:v}=e.body;if(!r||!a||!n)return t.status(400).json({error:"Titel, kunstenaar en type zijn verplicht."});let _=await i.Z.artwork.create({data:{title:r,artistId:parseInt(a),typeId:parseInt(n),height:s?parseFloat(s):null,width:o?parseFloat(o):null,depth:l?parseFloat(l):null,weight:u?parseFloat(u):null,year:p?parseInt(p):null,estimated:d||!1,isEdition:c||!1,editionDesc:k,isSigned:w||!1,signatureDesc:h,description:m,locationId:I?parseInt(I):null,purchaseDate:g?new Date(g):null,purchasePrice:y?parseFloat(y):null,supplier:f,marketValue:j?parseFloat(j):null,insuredValue:v?parseFloat(v):null}});return t.status(201).json(_)}catch(e){return console.error("Error creating artwork:",e),t.status(500).json({error:"Er is een fout opgetreden bij het aanmaken van het kunstwerk."})}},u=(0,l.fS)(handler),p=(0,o.l)(a,"default"),d=(0,o.l)(a,"config"),c=new n.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/artworks",pathname:"/api/artworks",bundlePath:"",filename:""},userland:a})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,896],()=>__webpack_exec__(8001));module.exports=r})();