"use strict";(()=>{var e={};e.id=749,e.ids=[749],e.modules={3524:e=>{e.exports=require("@prisma/client")},7096:e=>{e.exports=require("bcrypt")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6864:(e,t,r)=>{r.r(t),r.d(t,{config:()=>d,default:()=>l,routeModule:()=>p});var a={};r.r(a),r.d(a,{default:()=>c});var s=r(1802),n=r(7153),i=r(6249),o=r(7864),u=r(9823);let handler=async(e,t)=>{switch(e.method){case"GET":return getArtists(e,t);case"POST":return createArtist(e,t);default:return t.setHeader("Allow",["GET","POST"]),t.status(405).json({error:`Methode ${e.method} niet toegestaan`})}},getArtists=async(e,t)=>{try{let{search:r,country:a,page:s=1,limit:n=10}=e.query,i={};r&&(i.OR=[{name:{contains:r,mode:"insensitive"}},{city:{contains:r,mode:"insensitive"}}]),a&&(i.country={contains:a,mode:"insensitive"});let u=(parseInt(s)-1)*parseInt(n),[c,l]=await Promise.all([o.Z.artist.findMany({where:i,include:{_count:{select:{artworks:!0}}},skip:u,take:parseInt(n),orderBy:{name:"asc"}}),o.Z.artist.count({where:i})]),d=c.map(e=>({...e,artworkCount:e._count.artworks}));return t.status(200).json({artists:d,pagination:{total:l,page:parseInt(s),limit:parseInt(n),pages:Math.ceil(l/parseInt(n))}})}catch(e){return console.error("Error fetching artists:",e),t.status(500).json({error:"Er is een fout opgetreden bij het ophalen van kunstenaars."})}},createArtist=async(e,t)=>{try{let{name:r,address:a,city:s,country:n,email:i,phone:u,website:c,birthDate:l,deathDate:d,biography:p,portraitUrl:m}=e.body;if(!r)return t.status(400).json({error:"Naam is verplicht."});let h=await o.Z.artist.create({data:{name:r,address:a,city:s,country:n,email:i,phone:u,website:c,birthDate:l?new Date(l):null,deathDate:d?new Date(d):null,biography:p,portraitUrl:m}});return t.status(201).json(h)}catch(e){return console.error("Error creating artist:",e),t.status(500).json({error:"Er is een fout opgetreden bij het aanmaken van de kunstenaar."})}},c=(0,u.fS)(handler),l=(0,i.l)(a,"default"),d=(0,i.l)(a,"config"),p=new s.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/artists",pathname:"/api/artists",bundlePath:"",filename:""},userland:a})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,896],()=>__webpack_exec__(6864));module.exports=r})();