"use strict";exports.id=896,exports.ids=[896],exports.modules={9823:(e,r,s)=>{s.d(r,{Oe:()=>comparePassword,RA:()=>generateToken,c_:()=>hashPassword,fS:()=>authenticateToken});var t=s(9344),a=s.n(t),n=s(7096),o=s.n(n);let generateToken=e=>a().sign({id:e.id,email:e.email,role:e.role},process.env.JWT_SECRET,{expiresIn:"24h"}),hashPassword=async e=>await o().hash(e,10),comparePassword=async(e,r)=>await o().compare(e,r),authenticateToken=e=>async(r,s)=>{try{let t=r.headers.authorization,n=t&&t.split(" ")[1];if(!n)return s.status(401).json({error:"Toegang geweigerd. Token ontbreekt."});let o=a().verify(n,process.env.JWT_SECRET);return r.user=o,e(r,s)}catch(e){return s.status(401).json({error:"Ongeldige token."})}}},7864:(e,r,s)=>{let t;s.d(r,{Z:()=>a}),t=new(s(3524)).PrismaClient;let a=t}};